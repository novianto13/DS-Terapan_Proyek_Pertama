# -*- coding: utf-8 -*-
"""Project Pertama Terapan.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1WD43E3s5GpGqYaM5vNCfBIlwntMoJqf6

#Project pertama Data Science terapan IDC
nama : Novianto (novianto_j14b)

Link dashboard

https://public.tableau.com/views/ProjectpertamaDSTerapan/Dashboard1?:language=en-US&publish=yes&:sid=&:redirect=auth&:display_count=n&:origin=viz_share_link

#Business Understanting

Jaya Jaya Maju merupakan salah satu perusahaan multinasional yang telah berdiri sejak tahun 2000. Ia memiliki lebih dari 1000 karyawan yang tersebar di seluruh penjuru negeri. Walaupun telah menjadi menjadi perusahaan yang cukup besar, Jaya Jaya Maju masih cukup kesulitan dalam mengelola karyawan. Hal ini berimbas tingginya attrition rate (rasio jumlah karyawan yang keluar dengan total karyawan keseluruhan) hingga lebih dari 10%.

###Business problem

Dari latar belakang tersebut pertanyaan yang diajukan dalam project ini adalah

1.   Faktor apa yang mempengaruhi attririon

###Project Scope

Untuk menjawab permasalah bisnis tersebut maka aktivitas dalam project ini meliput:

1.   Pemahaman data untuk menjelaskan secara deskripsi data
2.   Menemukan faktor yang mempengaruhi attrition

###Persiapan
untuk menjelakan project ini, data yang diperlukan diambil dari case dicoding yang diberikan dengan akses berikut: https://github.com/dicodingacademy/dicoding_dataset/tree/main/employee

Untuk olah data, project ini menggunakan Google Colab dengan pemrograman pyton.

Hasil olah data ditampilkan dalam dashboard

# 1. Pemahaman Data

pada bagian ini akan dilakukan untuk menjelaskan data makna dalam dataset.
"""

import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns
import numpy as np

hr_df = pd.read_csv(
    "https://raw.githubusercontent.com/dicodingacademy/dicoding_dataset/main/employee/employee_data.csv",
    encoding='windows-1252'
)
hr_df.head(5)

hr_df.info()

hr_df.isna().sum()

"""Berikut adalah arti dari masing-masing elemen dalam hasil data:

1. **Total 35 kolom** – Data memiliki 35 variabel yang menggambarkan berbagai aspek dari karyawan.
2. **Non-Null Count** – Menunjukkan jumlah entri yang tidak kosong dalam setiap kolom. Misalnya, kolom *Attrition* hanya memiliki 1058 entri, yang berarti ada beberapa nilai yang hilang (missing values) sebanyak 412.
3. **Dtype** – Menunjukkan tipe data dari setiap kolom:
   - **int64** → Bilangan bulat (integer)
   - **float64** → Bilangan desimal (floating point)
   - **object** → Data kategori atau teks

Berikut beberapa variabel utama dan artinya:
- **EmployeeId** → ID unik untuk setiap karyawan.
- **Age** → Usia karyawan.
- **Attrition** → Indikator apakah karyawan telah keluar dari perusahaan (1 untuk keluar, 0 untuk tetap).
- **BusinessTravel** → Kategori perjalanan bisnis yang dilakukan karyawan.
- **DailyRate & MonthlyRate** → Gaji harian dan bulanan karyawan.
- **Department** → Departemen tempat karyawan bekerja (misalnya HR, R&D, Sales).
- **DistanceFromHome** → Jarak rumah ke kantor.
- **Education & EducationField** → Tingkat pendidikan dan bidang studi karyawan.
- **EnvironmentSatisfaction** → Kepuasan karyawan terhadap lingkungan kerja.
- **JobInvolvement & JobSatisfaction** → Seberapa terlibat dan puas karyawan dalam pekerjaannya.
- **MonthlyIncome** → Pendapatan bulanan karyawan.
- **OverTime** → Apakah karyawan bekerja lembur atau tidak.
- **PerformanceRating** → Rating kinerja karyawan.
- **WorkLifeBalance** → Indikator keseimbangan kehidupan kerja karyawan.
- **YearsAtCompany & YearsInCurrentRole** → Lama bekerja di perusahaan dan dalam peran saat ini.
- **YearsSinceLastPromotion** → Waktu sejak promosi terakhir.

##1.2. Eksplorasi data
Pada bagian ini visualisasi data dilakukan untuk memberikan gambaran tentang data.

Untuk mempermudah pemahaman data maka data project diarahkan pada beberapa variabel.
"""

# memilih variabel utama untuk analisa lebih lanjut
selected_columns = [
    'EmployeeId', 'Age', 'Attrition', 'BusinessTravel', 'DailyRate',
    'MonthlyRate', 'Department', 'DistanceFromHome', 'Education',
    'EducationField', 'EnvironmentSatisfaction', 'JobInvolvement',
    'JobSatisfaction', 'MonthlyIncome', 'OverTime', 'PerformanceRating',
    'WorkLifeBalance', 'YearsAtCompany', 'YearsInCurrentRole',
    'YearsSinceLastPromotion', 'JobLevel'
]

new_df = hr_df[selected_columns]

new_df.head(5)

new_df.info()

new_df.describe(include='all')

"""Berdasarkan data statistik yang diberikan, berikut beberapa temuan menarik:

### 1️⃣ **Karakteristik Karyawan**
- **Usia rata-rata** adalah sekitar **36,9 tahun**, dengan rentang usia dari **18 hingga 60 tahun**.
- **Jumlah tahun bekerja di perusahaan** memiliki rata-rata **7 tahun**, tetapi ada karyawan yang sudah bekerja hingga **40 tahun**.
- **Rata-rata tahun dalam peran saat ini** adalah sekitar **4,2 tahun**, menunjukkan adanya stabilitas dalam posisi pekerjaan.

### 2️⃣ **Kesejahteraan & Kepuasan**
- **Keseimbangan kehidupan kerja** memiliki nilai rata-rata **2,72**, menunjukkan bahwa beberapa karyawan mungkin mengalami tantangan dalam menyeimbangkan pekerjaan dan kehidupan pribadi.
- **Kepuasan pekerjaan** memiliki distribusi yang cukup luas, dari **1 (sangat tidak puas) hingga 4 (sangat puas)**, dengan median sekitar **3**.
- **Kepuasan lingkungan kerja** juga bervariasi, dengan angka tertinggi mencapai **4**.

### 3️⃣ **Gaji dan Insentif**
- **Pendapatan bulanan rata-rata** adalah sekitar **14.313**, dengan nilai minimum **2094** dan maksimum **26.999**. Ini menunjukkan adanya kesenjangan yang cukup besar dalam distribusi gaji.
- **Karyawan dengan opsi saham** tampaknya memiliki beberapa tingkatan berbeda, meskipun ini tidak dijelaskan dalam data.
- **Peningkatan gaji tahunan** memiliki nilai rata-rata **2,91%**, yang mungkin mempengaruhi kepuasan dan motivasi kerja.

### 4️⃣ **Perjalanan Bisnis & Departemen**
- **Mayoritas karyawan jarang melakukan perjalanan bisnis** (*Travel_Rarely* muncul sebanyak **1043 kali**).
- **Departemen terbesar adalah Research & Development**, yang memiliki **961 karyawan** dibandingkan departemen lain seperti Sales atau HR.

### 5️⃣ **Promosi & Rotasi**
- **Rata-rata waktu sejak promosi terakhir** adalah sekitar **7 tahun**, dengan beberapa karyawan yang belum mendapatkan promosi selama **40 tahun**.
- **Beberapa karyawan tidak mengalami perpindahan perusahaan**, tetapi ada yang memiliki pengalaman bekerja di beberapa perusahaan sebelum ini.

### **Kesimpulan**
Data ini menunjukkan pola yang menarik terkait kepuasan kerja, keseimbangan kehidupan kerja, serta struktur gaji dan perjalanan bisnis. Jika dianalisis lebih lanjut, mungkin bisa ditemukan hubungan antara kepuasan kerja dan faktor-faktor seperti **gaji, perjalanan bisnis, atau kesempatan promosi**.

"""

# Select numerical columns
numerical_cols = new_df.select_dtypes(include=[np.number]).columns

# Create histograms
new_df[numerical_cols].hist(figsize=(15, 10))  # Adjust figsize for better visualization
plt.tight_layout()
plt.show()

"""Hasil visualisasi histogram tesebut menunjukkan jumlah karyawan yang keluar lebih banyak dari yang masih bekerja.

Dominasi Karyawan Muda: Distribusi usia menunjukkan perusahaan memiliki banyak karyawan muda, yang mungkin berkaitan dengan tingginya attrition pada masa kerja awal.

Tingkat Attrition Tinggi di Awal Karir: Karyawan baru cenderung lebih sering mengundurkan diri, yang ditunjukkan oleh data years at company yang didominasi oleh pekerja dengan lama kerja 0-10 tahun

Kepuasan Sedang: Nilai kepuasan kerja dan lingkungan tidak terlalu tinggi (rata-rata 3.0–3.5), mengindikasikan perlunya perbaikan di area tertentu.

Keseimbangan Hidup-Kerja Cukup Baik: Meski tidak ideal, karyawan merasa cukup nyaman dengan keseimbangan ini.



"""

# Select numerical columns
numerical_cols = new_df.select_dtypes(include=['float64', 'int64']).columns

# Create the pair plot
sns.pairplot(new_df[numerical_cols])
plt.show()

"""Hasil visualisasi pairplot menunjukkan secara umum tidak ada gambar khusus yang meunjukkan pola pengaruh linear. Indikasi hanya pada variabel lama bekerja di perusahaan yearatthecompany."""

# Select numerical columns
numerical_cols = new_df.select_dtypes(include=[np.number]).columns

# Calculate the correlation matrix
correlation_matrix = new_df[numerical_cols].corr()

# Create a heatmap
plt.figure(figsize=(12, 10))  # Adjust the figure size if needed
sns.heatmap(correlation_matrix, annot=True, cmap='coolwarm', fmt=".2f")
plt.title('Correlation Matrix of Numerical Variables')
plt.tight_layout()
plt.show()

"""Matriks korelasi menunjukkan hubungan linier antar variabel numerik dalam dataset karyawan. Nilai berkisar dari -1 (korelasi negatif sempurna) hingga 1 (korelasi positif sempurna). Nilai mendekati 0 menunjukkan tidak ada hubungan.
Beberapa pola penting yang teridentifikasi:

**Korelasi Signifikan**

Age (Usia) vs. MonthlyIncome (Pendapatan Bulanan) = Korelasi: 0.50. Interpretasi: Karyawan dengan usia lebih tinggi cenderung memiliki pendapatan lebih besar. Ini mungkin terkait pengalaman atau jenjang karir.

YearsAtCompany (Lama Bekerja) vs. YearsInCurrentRole (Lama di Posisi Saat Ini) = Korelasi: 0.76. Interpretasi: Hubungan sangat kuat. Karyawan yang lama di perusahaan cenderung menempati posisi yang sama dalam waktu panjang.

YearsAtCompany vs. MonthlyIncome = Korelasi: 0.51. Interpretasi: Karyawan dengan masa kerja panjang umumnya memiliki pendapatan lebih tinggi (efek kenaikan gaji tahunan/promosi).

Attrition (Pengunduran Diri) vs. Age = Korelasi: -0.17. Interpretasi: Karyawan muda lebih mungkin mengundurkan diri.

Attrition vs. MonthlyIncome = Korelasi: -0.16. Interpretasi: Karyawan dengan pendapatan rendah lebih rentan resign.

Attrition vs. MonthlyIncome = Korelasi: -0.16. Interpretasi: Karyawan dengan pendapatan rendah lebih rentan resign.

Attrition vs. Joblevel = Korelasi: -0.17. Interpretasi: Karyawan dengan posisi rendah lebih rentan resign.


"""

# Select categorical columns
categorical_cols = new_df.select_dtypes(include=['object']).columns

# Create bar charts for each categorical column
for col in categorical_cols:
    plt.figure(figsize=(8, 6))  # Adjust figure size if needed
    sns.countplot(x=col, data=new_df)
    plt.title(f'Distribution of {col}')  # Set title for each chart
    plt.xticks(rotation=45)  # Rotate x-axis labels for better readability
    plt.tight_layout()
    plt.show()

"""Data tersebut menjelaskan bahwa karyawan terbanyak adalah dari bagian RnD. Karyawan ini jarang melakukan perjalanan bisnis dan jarang untuk melakukan lebur."""

# Create a grouped bar chart
plt.figure(figsize=(10, 6))
sns.countplot(x='Department', hue='Attrition', data=new_df)
plt.title('Attrition Rate by Department')
plt.xlabel('Department')
plt.ylabel('Number of Employees')
plt.xticks(rotation=45)  # Rotate x-axis labels for better readability
plt.legend(title='Attrition', loc='upper right')
plt.tight_layout()
plt.show()

"""dari visualisasi tersebut, dapat dipahami bahwa karyawan di departemen RnD merupakan karwayan yang banyak mengundurkan diri.

# 2. Data Preperation

Pada tahap ini, olah data dilakukan untuk mempersiapkan data untuk modeling. Tahapan ini dilakukan dengan cara:
1. Melakukan perbaikan data,
2. Pembersihan data

Karena tipe data tidak memiliki masalah, maka data preparataion akan dilakukan dengan pembersihan data.
"""

#dataset yang akan dibersihkan
new_df.info()

# Remove rows with missing values in the 'Attrition' column
new_df_cleaned = new_df.dropna(subset=['Attrition'])

# Display the shape of the cleaned DataFrame
print(f"Shape of original DataFrame: {new_df.shape}")
print(f"Shape of cleaned DataFrame: {new_df_cleaned.shape}")

# Display the number of rows in the cleaned DataFrame
num_rows_cleaned = new_df_cleaned.shape[0]
print(f"Number of rows after removing NaN in 'Attrition': {num_rows_cleaned}")

new_df_cleaned.info()

"""Pembersiah data dilakukan terhadap data data kosong atau missing value pada variabel attrition. Hasilnya adalah terdapat 1058 data yang siap untuk diolah lebih lanjut"""

# Calculate the percentage of attrition with value 1
attrition_1_percentage = (new_df_cleaned['Attrition'] == 1.0).sum() / len(new_df_cleaned) * 100
attrition_0_percentage = (new_df_cleaned['Attrition'] == 0.0).sum() / len(new_df_cleaned) * 100

# Print the percentage
print(f"Percentage of Attrition with value 1: {attrition_1_percentage:.2f}%")
print(f"Percentage of Attrition with value 0: {attrition_0_percentage:.2f}%")

# Data for the pie chart
labels = ['Keluar (1)', 'Tetap (0)']
sizes = [attrition_1_percentage, attrition_0_percentage]
colors = ['red', 'green']  # You can customize the colors
explode = (0.1, 0)  # Explode the first slice (Attrition = 1)

# Create the pie chart
plt.figure(figsize=(6, 6))
plt.pie(sizes, explode=explode, labels=labels, colors=colors, autopct='%1.1f%%', shadow=True, startangle=90)
plt.title('Attrition Percentage')
plt.axis('equal')  # Equal aspect ratio ensures that pie is drawn as a circle.
plt.show()

"""Setelah data dibersihakn, maka dapat dihitung berapa persen karyawan yang tetap dan yang keluar. Nilai 1 untuk menunjukkan status karyawan yang sudah keluar dan nilai 0 menunjukkan karyawan yang masih bekerja. Hasil menunjukkan bahwa karyawan yang keluar adalah 16.9% dari keseluruhan karyawan.

# 3. Modeling

Pada bagian modeling, data akan disusun dalam model untuk dapat melihat faktor apa yang mempengaruhi attretion karyawan.

Untuk membuat model ini ditentukan variabel y adalah attrition, variabel x adalah semua variabel yang memiliki tipe data numeric. Model yang dengan bangun menggunakan **regresi logistik**.

Tujuan dari regresi ini adalah untuk melihat dampak bagaimana pengaruh faktor-faktor tersebut terhadap kemungkinan karyawan untuk keluar
"""

import pandas as pd
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LogisticRegression
import statsmodels.api as sm

numerical_cols = new_df_cleaned.select_dtypes(include=['int64', 'float64']).columns
X = new_df_cleaned[numerical_cols.drop('Attrition')]  # Drop 'Attrition' dari variabel X
y = new_df_cleaned['Attrition']

# Tambahkan konstanta untuk statsmodels
X_const = sm.add_constant(X)

# Model regresi logistik dengan statsmodels untuk melihat signifikansi
model = sm.Logit(y, X_const)
result = model.fit()

# Tampilkan ringkasan hasil regresi
print(result.summary())

"""Berikut adalah interpertasi dari hasil regresi logistik

| Variabel                  | Koefisien  | Arah Pengaruh          | Keterangan |
|---------------------------|------------|--------------------------|------------|
| Age                       | -0.0332    | Negatif                 | Semakin tua, semakin kecil kemungkinan keluar. |
| DistanceFromHome          | 0.0263     | Positif                 | Semakin jauh jarak dari rumah, semakin besar kemungkinan keluar. |
| EnvironmentSatisfaction   | -0.3395    | Negatif                 | Kepuasan lingkungan kerja menurunkan attrition. |
| JobInvolvement            | -0.5781    | Negatif                 | Keterlibatan kerja yang tinggi mengurangi attrition. |
| JobSatisfaction           | -0.2940    | Negatif                 | Kepuasan kerja menurunkan attrition. |
| WorkLifeBalance           | -0.2747    | Negatif                 | Keseimbangan hidup-kerja lebih baik mengurangi attrition. |
| YearsInCurrentRole        | -0.1403    | Negatif                 | Lama di posisi sekarang → lebih kecil kemungkinan keluar. |
| YearsSinceLastPromotion   | 0.1354     | Positif                 | Semakin lama sejak promosi terakhir → lebih besar kemungkinan keluar. |

**Makna temuan hasil**


Faktor uang (gaji, pendapatan harian/bulanan) tidak terbukti signifikan mempengaruhi attrition dalam model ini.

Faktor psikologis dan lingkungan kerja seperti JobSatisfaction, EnvironmentSatisfaction, dan JobInvolvement justru lebih kuat berpengaruh.

Hal ini menunjukkan bahwa untuk mengurangi attrition, perusahaan sebaiknya fokus pada peningkatan kepuasan kerja dan lingkungan kerja, bukan hanya menaikkan gaji.

Model

![image.png](data:image/png;base64,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)


logit(p) = 4.6009 - 0.0332(Age) + 0.0263(DistanceFromHome) - 0.3395(EnvironmentSatisfaction) - 0.5781(JobInvolvement) - 0.2940(JobSatisfaction) - 0.2747(WorkLifeBalance) - 0.0156(YearsAtCompany) - 0.1403(YearsInCurrentRole) + 0.1354(YearsSinceLastPromotion)
"""

# Mendapatkan koefisien dan p-value dari hasil model
coefficients = result.params
p_values = result.pvalues

# Membuat DataFrame untuk visualisasi
coef_df = pd.DataFrame({'Koefisien': coefficients, 'P-value': p_values})
coef_df = coef_df.drop('const')  # Menghapus baris 'const' (intercept)

# Mengurutkan berdasarkan nilai absolut koefisien
coef_df = coef_df.sort_values(by='Koefisien', key=abs, ascending=False)


# Membuat bar chart horizontal untuk koefisien
plt.figure(figsize=(10, 6))
plt.barh(coef_df.index, coef_df['Koefisien'], color=np.where(coef_df['P-value'] < 0.05, 'blue', 'gray'))
plt.title('Koefisien Model Regresi Logistik (Statsmodels)')
plt.xlabel('Koefisien')
plt.ylabel('Fitur')

# Menambahkan tanda bintang untuk koefisien yang signifikan
for i, v in enumerate(coef_df['Koefisien']):
    if coef_df['P-value'][i] < 0.05:
        plt.text(v, i, '*', color='black', ha='left', va='center', fontsize=12)

plt.show()

"""**Interpretasi Hasil**

Variabel signifikan negatif (mencegah attrition):
JobInvolvement: Koefisien negatif besar (sekitar -0.58), artinya semakin tinggi keterlibatan kerja, semakin kecil kemungkinan karyawan keluar.

Environment Satisfaction, Job Satisfaction, Work Life Balance, Years In CurrentRole, Age: Semua ini memiliki efek negatif terhadap attrition — artinya, kepuasan, keseimbangan hidup-kerja, dan senioritas mengurangi risiko keluar.

Variabel signifikan positif (meningkatkan attrition):
Distance FromHome: Semakin jauh jarak ke kantor, semakin besar kemungkinan karyawan keluar.

Years Since Last Promotion: Semakin lama tidak dipromosikan, semakin tinggi kemungkinan keluar.

Variabel tidak signifikan (abu-abu):
MonthlyIncome, MonthlyRate, DailyRate, EmployeeId, Education, PerformanceRating, JobLevel, YearsAtCompany
→ Semua ini tidak terbukti punya pengaruh yang berarti terhadap attrition, meskipun secara umum sering dianggap relevan.

**Makna Visualisasi**

Visualisasi ini memperkuat kesimpulan sebelumnya bahwa faktor-faktor psikologis dan keterlibatan kerja lebih penting daripada faktor finansial seperti gaji.

Variabel yang secara signifikan memengaruhi attrition dapat menjadi target intervensi HR, seperti:

Meningkatkan kepuasan kerja dan keterlibatan.

Memperhatikan promosi tepat waktu.

Mengelola keseimbangan kerja–hidup karyawan.

#4. Evaluasi model
Pada tahap ini model dan hasil yang sudah dibuat sebelumnya akan dievaluasi tingkat akurasi dari hasil tersebut.

Model telah dibangun dengan Regresi Logistik, nilai koefisien akan memprediksi kemungkinan terjadinya attrition. Namun model dan nilai koefisien perlu dievaluasi.
"""

import pandas as pd
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LogisticRegression
from sklearn.metrics import accuracy_score, classification_report, confusion_matrix

# Pilih kolom dengan tipe data int dan 'Attrition'
numerical_cols = new_df_cleaned.select_dtypes(include=['int64', 'float64']).columns
X = new_df_cleaned[numerical_cols.drop('Attrition')]  # Drop 'Attrition' dari variabel X
y = new_df_cleaned['Attrition']

# Bagi data menjadi data training dan testing
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)

# Buat model regresi logistik
model = LogisticRegression()

# Latih model
model.fit(X_train, y_train)

# Prediksi pada data testing
y_pred = model.predict(X_test)

# Evaluasi performa model
accuracy = accuracy_score(y_test, y_pred)
print(f"Accuracy: {accuracy}")

# Tampilkan laporan klasifikasi dan confusion matrix
print(classification_report(y_test, y_pred))
print(confusion_matrix(y_test, y_pred))

"""**Penjelasan**
Walaupun model memiliki akurasi tinggi 81%. Namun Model ini gagal dalam mendeteksi karyawan yang akan keluar, meskipun akurasinya tampak tinggi. Anda perlu menangani ketidakseimbangan data agar model menjadi benar-benar berguna untuk prediksi attrition.

Hal ini mungkin dikarenakan regresi logistik menilai kemungkinan dari suatu faktor y.
"""

# KNN
from sklearn.neighbors import KNeighborsRegressor
from sklearn.metrics import mean_squared_error

knn = KNeighborsRegressor(n_neighbors=10) #Removed extra indentation
knn.fit(X_train, y_train)

model = mean_squared_error(y_pred = knn.predict(X_train), y_true=y_train)

# Random Forest
    # Impor library yang dibutuhkan
    from sklearn.ensemble import RandomForestRegressor

    # buat model prediksi
    RF = RandomForestRegressor(n_estimators=50, max_depth=16, random_state=55, n_jobs=-1)
    RF.fit(X_train, y_train)

    models = mean_squared_error(y_pred=RF.predict(X_train), y_true=y_train)

#Boosting

    from sklearn.ensemble import AdaBoostRegressor

    boosting = AdaBoostRegressor(learning_rate=0.05, random_state=55)
    boosting.fit(X_train, y_train)
    models = mean_squared_error(y_pred=boosting.predict(X_train), y_true=y_train)

# Buat variabel mse yang isinya adalah dataframe nilai mse data train dan test pada masing-masing algoritma
mse = pd.DataFrame(columns=['train', 'test'], index=['KNN','RF','Boosting'])

# Buat dictionary untuk setiap algoritma yang digunakan
model_dict = {'KNN': knn, 'RF': RF, 'Boosting': boosting}

# Hitung Mean Squared Error masing-masing algoritma pada data train dan test
for name, model in model_dict.items():
    mse.loc[name, 'train'] = mean_squared_error(y_true=y_train, y_pred=model.predict(X_train))/1e3
    mse.loc[name, 'test'] = mean_squared_error(y_true=y_test, y_pred=model.predict(X_test))/1e3

# Panggil mse
mse

fig, ax = plt.subplots()
mse.sort_values(by='test', ascending=False).plot(kind='barh', ax=ax, zorder=3)
ax.grid(zorder=0)

"""Penjelasan:

KNN: Sangat lambat saat prediksi (test), karena menghitung jarak ke semua data latih.

Boosting: Berat di dua sisi — butuh waktu lama saat pelatihan dan prediksi.

Random Forest: Cepat saat train, tapi agak lambat saat prediksi dalam visualisasi ini.

Trade-off yang ditampilkan: kecepatan vs kompleksitas dari masing-masing algoritma.

#5. Kesimpulan

Proyek ini menjelaskan faktor apa yang menyebabkan attrition karyawan. Hasil model ini mengindikasikan bahwa faktor yang menyebabkan karyawan keluar / attrition adalah:

JobInvolvement: Koefisien negatif besar semakin kecil kemungkinan karyawan keluar.

Environment Satisfaction, Job Satisfaction, Work Life Balance, Years In CurrentRole, Age: Semua ini memiliki efek negatif terhadap attrition — artinya, kepuasan, keseimbangan hidup-kerja, dan senioritas mengurangi risiko keluar.

Variabel signifikan positif (meningkatkan attrition): Distance From Home: Semakin jauh jarak ke kantor, semakin besar kemungkinan karyawan keluar.

Years Since Last Promotion: Semakin lama tidak dipromosikan, semakin tinggi kemungkinan keluar.

## 5.1. Rekomendasi Action Items

Dari hasil deskriptif dan analisa yang dilakukan maka rekomendasi untuk mengurangi tingkat attrition:

1. Peningkatan faktor psikologi kerja seperti kepuasan dan keterlibatan karyawan perlu ditingkatkan untuk dapat mengurangi tingkat attrition.
2. Perusahaan dapat membantu untuk karyawan memiliki tempat tinggal atau bertempat tinggal yang dekat dengan kantor untuk mengurangi tingkat attrition
3. Perusanaan perlu memperbaiki sistem promosi dengan memberikan kejelasan tahapan dan waktu pencapaian promosi untuk mengurangi attrition, karena semakin lama promosi maka kecenderungan karyawan untuk keluar semakin tinggi.
"""

import joblib

# Simpan model
joblib.dump(model, 'attrition_model.joblib')

# Muat model
loaded_model = joblib.load('attrition_model.joblib')

!pip freeze > requirements.txt